
<div class="panel panel-default">
    <div class="panel-heading">
      Danh sách mã giảm giá
    </div>
    
    <div class="table-responsive">
      <table class="table table-striped b-t b-light">
          <thead>
              <tr>
                <th>Mã giảm giá</th>
                <th>Phần trăm giảm</th>
                <th>Ngày áp dụng</th>
                <th>Ngày hết hạn</th>
                <th style="width:30px;"></th>
              </tr>
          </thead>
          <tbody id="all-discount">
            
          </tbody>
      </table>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function() {
      $.ajax({
            type: "GET",
            url: "http://localhost:8006/api/all-discount",
            dataType: 'json',
            success: function (data) {
                const discounts = $('#all-discount');
                discounts.empty(); 
                data.data.forEach(function(discount) {
                    const discountName = discount.discount_name;
                    const discountPercent = discount.discount_percent	;
                    const startDate = discount.start_date;
                    const endDate = discount.end_date;
                    const row = `
                      <tr>
                        <td>${discountName}</td>
                        <td>${discountPercent}</td>
                        <td>${startDate}</td>
                        <td>${endDate}</td>
                        <td>
                          <a href="" class="active styling-edit" ui-toggle-class="">
                            <i class="fa fa-pencil-square-o text-success text-active"></i>
                          </a>
                          <a href="" class="active styling-edit delete-discount" data-id="" ui-toggle-class="">
                            <i class="fa fa-times text-danger text"></i>
                          </a>
                        </td>
                      </tr>
                    `;
                    discounts.append(row);
                    
                });
            },
            error: function (e) {
                console.log(xhr.responseText);
            }
        });


      var csrfToken = $('meta[name="csrf-token"]').attr('content');
  
      $('.delete-discount').on('click', function(event) {
          event.preventDefault();
          var discountId = $(this).data('id');
          if (confirm("Bạn có chắc chắn muốn xóa mã giảm giá này không?")){
            $.ajax({
                url: "delete-discount/" + discountId,
                type: 'DELETE',
                contentType: 'application/json',
                headers: {
                  'X-CSRF-TOKEN': csrfToken, 
                },
                success: function(response) {
                  alert('Xóa mã giảm giá thành công');
                  location.reload();
                },
                error: function(xhr, status, error) {
                  console.log(xhr.responseText);
                }
            });
          }
      });
    });
</script>