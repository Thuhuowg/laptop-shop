
<div class="table-agile-info">
    <div class="panel panel-default">
        <div class="panel-heading">
            Danh sách sản phẩm
        </div>
    
        <div class="table-responsive">
            <table class="table table-striped b-t b-light">
                <thead>
                    <tr>
                        <th>Tên sản phẩm</th>
                        <th>Danh mục</th>
                        <th>Giá</th>
                        <th>Giảm giá</th>
                        <th>Ngày áp dụng</th>
                        <th>Ngày hết hạn</th>
                        <th>Hiển thị</th>
                        <th style="width:30px;"></th>
                    </tr>
                </thead>
                <tbody id="all-product">
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td><span class="text-ellipsis">
                            <a href=""><span class="fa-thumb-styling fa fa-thumbs-up"></span></a>
                        </span></td>
                        <td>
                            <a href="" class="active styling-edit" ui-toggle-class="">
                                <i class="fa fa-pencil-square-o text-success text-active"></i>
                            </a>
                            <a href="" class="active styling-edit delete-discount" data-id="" ui-toggle-class="">
                                <i class="fa fa-times text-danger text"></i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
    // Gọi API và tải nội dung sản phẩm
    fetch('http://127.0.0.1:8000/api/v1/products')
        .then(response => response.json())
        .then(data => {
            const productTable = document.getElementById('all-product');
            
            // Kiểm tra nếu không có dữ liệu
            if (!data || data.length === 0) {
                productTable.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center">Không có sản phẩm nào để hiển thị.</td>
                    </tr>
                `;
                return;
            }

            data.forEach(product => {
                const productName = product.product_name || 'Không có tên';
                const categoryName = product.category?.category_name || 'Không có danh mục';
                const productPrice = product.price || 0;
                const discountPercent = product.discount?.discount_percent || '0%';
                const startDate = product.discount?.start_date || 'N/A';
                const endDate = product.discount?.end_date || 'N/A';

                const row = `
                    <tr>
                        <td>${productName}</td>
                        <td>${categoryName}</td>
                        <td>${new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(productPrice)}</td>
                        <td>${discountPercent}</td>
                        <td>${startDate}</td>
                        <td>${endDate}</td>
                        <td><span class="text-ellipsis">
                            <a href="#"><span class="fa-thumb-styling fa fa-thumbs-up"></span></a>
                        </span></td>
                        <td>
                            <a href="#" class="active styling-edit">
                                <i class="fa fa-pencil-square-o text-success"></i>
                            </a>
                            <a href="#" class="active styling-edit delete-product" data-id="${product.id}">
                                <i class="fa fa-times text-danger"></i>
                            </a>
                        </td>
                    </tr>
                `;
                productTable.insertAdjacentHTML('beforeend', row);
            });
        })
        .catch(error => {
            console.log('Lỗi khi tải sản phẩm:', error);
            const productTable = document.getElementById('all-product');
            productTable.innerHTML = `
                <tr>
                    <td colspan="7" class="text-center text-danger">Không thể tải danh sách sản phẩm. Vui lòng thử lại sau.</td>
                </tr>
            `;
        });
});

</script>